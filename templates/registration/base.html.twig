{# templates/registration/base.html.twig #}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
  <div class="min-h-screen flex flex-col">

    {# Top bar với nút back về Home #}
    <header class="border-b border-gray-200 bg-white/80 backdrop-blur">
      <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between gap-4">
        <a href="{{ path('app_homepage') }}"
           class="inline-flex items-center gap-2 text-sm text-gray-700 hover:text-violet-600">
          <span class="text-lg">&larr;</span>
          <span>Back to PC Store</span>
        </a>

        <a href="{{ path('app_homepage') }}" class="flex items-center gap-2 text-sm font-semibold text-gray-900">
          <span
            class="h-7 w-7 rounded-xl bg-violet-600 text-white flex items-center justify-center text-xs font-bold">
            PC
          </span>
          <span>PC Store</span>
        </a>
      </div>
    </header>

    <main class="flex-1">
      {% block body %}{% endblock %}
    </main>

    {# ===== Global flash toasts (center top) ===== #}
    <div id="flash-root"
         class="fixed inset-x-0 top-4 flex justify-center z-50 pointer-events-none">
      <div class="w-full max-w-md px-4 space-y-2">
        {% set flashTypes = {
          'shop.success': 'bg-emerald-600 text-white',
          'shop.error':   'bg-rose-600 text-white',
          'shop.info':    'bg-sky-600 text-white'
        } %}

        {% for type, classes in flashTypes %}
          {% for message in app.flashes(type) %}
            <div class="flash-item pointer-events-auto rounded-xl shadow-lg px-4 py-3 text-sm
                        {{ classes }} transition transform duration-300">
              {{ message }}
            </div>
          {% endfor %}
        {% endfor %}
      </div>
    </div>

  </div>

  {# ===== Lucide icons + password eye toggle (for all auth pages) ===== #}
  <script src="https://unpkg.com/lucide@latest"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (window.lucide) {
        lucide.createIcons();
      }

      document.querySelectorAll('.flash-item').forEach((el) => {
        setTimeout(() => {
          el.classList.add('opacity-0', 'translate-y-2');
          el.addEventListener('transitionend', () => el.remove());
        }, 3500);
      });
    });

    document.addEventListener('click', (e) => {
      const btn = e.target.closest('[data-eye]');
      if (!btn) return;

      const input  = btn.parentElement.querySelector('input[type="password"], input[type="text"]');
      const openI  = btn.querySelector('[data-eye-open]');
      const closeI = btn.querySelector('[data-eye-closed]');
      if (!input || !openI || !closeI) return;

      const willShow = input.type === 'password';
      input.type = willShow ? 'text' : 'password';
      openI.classList.toggle('hidden',  willShow);
      closeI.classList.toggle('hidden', !willShow);
    });
  </script>
</body>
</html>

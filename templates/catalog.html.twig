{% extends 'base.html.twig' %}
{% block title %}Catalog — PC Store{% endblock %}

{% block body %}
<section class="bg-base-100">
  <div class="max-w-7xl mx-auto px-4 lg:px-8 py-8">

    <div class="flex items-center justify-between gap-4 mb-6">
      <h1 class="text-2xl font-semibold">Catalog</h1>

      <form method="get" class="flex items-center gap-2">
        <input type="hidden" name="q" value="{{ q }}">
        {% if cat %}<input type="hidden" name="cat" value="{{ cat }}">{% endif %}

        <select name="sort" class="select select-bordered select-sm">
          <option value="newest"    {{ sort=='newest' ? 'selected' }}>Newest</option>
          <option value="name_asc"  {{ sort=='name_asc' ? 'selected' }}>Name A→Z</option>
          <option value="name_desc" {{ sort=='name_desc' ? 'selected' }}>Name Z→A</option>
          <option value="price_asc" {{ sort=='price_asc' ? 'selected' }}>Price low → high</option>
          <option value="price_desc"{{ sort=='price_desc' ? 'selected' }}>Price high → low</option>
          <option value="qty_asc"   {{ sort=='qty_asc' ? 'selected' }}>Stock low → high</option>
          <option value="qty_desc"  {{ sort=='qty_desc' ? 'selected' }}>Stock high → low</option>
        </select>
        <button class="btn btn-primary btn-sm">Apply</button>
        <a href="{{ path('catalog') }}" class="btn btn-ghost btn-sm">Clear</a>
      </form>
    </div>

    <form method="get" class="grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6">
      <input name="q" value="{{ q }}" class="input input-bordered w-full" placeholder="Search products..." />
      <select class="select select-bordered w-full" name="cat">
        <option value="">All categories</option>
        {% for c in categories %}
          <option value="{{ c.id }}" {{ cat is defined and cat == c.id ? 'selected' : '' }}>{{ c.name }}</option>
        {% endfor %}
      </select>
      <button class="btn btn-primary">Search</button>
    </form>

    {% if products is empty %}
      <div class="text-center text-base-content/60 py-20">No matching products.</div>
    {% else %}
      {# SAME CARD SIZE EVERYWHERE #}
      <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
        {% for p in products %}
          {% include '_components/product-card.html.twig' with { p: p, specs_count: 4 } %}
        {% else %}
          <p class="col-span-full text-center text-base-content/60 py-8">No products.</p>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</section>
{% endblock %}
